<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>Lesson 1: Dynamic Images, Part 1</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', '03048.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00410.html" target="topic">MPLAB® Harmony Graphics Suite</a> &gt; <a href="03039.html" target="topic">Advanced Topics</a> &gt; <a href="03046.html" target="topic">Dynamic Graphics</a> &gt; <a href="03048.html" target="topic">Lesson 1: Dynamic Images, Part 1</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB® Harmony Graphics Suite</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00410.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="03047.html" target="topic">Previous</a> | <a href="03046.html" target="topic">Up</a> | <a href="03049.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: MHGC UG Dynamic Images, Part 1 Topic Title: Lesson 1: Dynamic Images, Part 1)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table><div class="Element5">
Lesson 1: Dynamic Images, Part 1</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
This tutorial lesson shows how to add a simple event to the Aria Quickstart demonstration’s button. </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG QuickStart Home Screen.png" border="0" alt="" title=""></p><p class="Element10">
&nbsp;</p>
<p class="Element10">
Pressing the “Make Changes. Generate. Run.” button will hide the MPLAB Harmony Logo image. Releasing the button will restore the logo. (For details on how to load, build, program, and run this project, see MPLAB Harmony Graphics Library Help &gt; Graphics Demonstrations &gt; Demonstrations &gt; aria_quickstart.)&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>The steps are as follows:</strong>&nbsp;</p>
<p class="Element10">
1. Make a copy of the ./gfx/apps/aria_quickstart folder on your hard drive.&nbsp;</p>
<p class="Element10">
(Located at .\gfx\apps\aria_quickstart\firmware\<a href="00022.html" target="topic">aria_qs_e70_xu_tm4301b.X</a>)&nbsp;</p>
<p class="Element10">
Then Load the copied aria_quickstart project into the MPLAB.X IDE.&nbsp;</p>
<p class="Element10">
2. Launch the MPLAB Harmony Configurator: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG Launch H3 Configurator.png" border="0" alt="" title=""></p><p class="Element10">
3. Open the project’s default saved state: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG Config Save State.png" border="0" alt="" title=""></p><p class="Element10">
4. Select the Graphics Composer from the MHC Pull-Down Menu which will open a new window for the MPLAB Harmony Graphics Composer: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG Pull Down Menu.png" border="0" alt="" title=""></p><p class="Element10">
&nbsp;</p>
<p class="Element10" style="text-align: center;">
<img src="MHGC UG Graphics Composer.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10" style="text-align: center;">
&nbsp;</p>
<p class="Element10">
5. Select the Composer Screen Designer panel and select the <strong>ButtonWidget1</strong> (“Make changes. Generate. Run”): </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ButtonWidget1.png" border="0" alt="" title=""></p><p class="Element10">
6. Under the Properties Edtor panel on the right side of the screen, the properties of ButtonWidget1 should appear. Make the button <strong>Toggleable</strong>: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ButonWidget1 Toggle.png" border="0" alt="" title=""></p><p class="Element10">
7. Enable the <strong>Pressed</strong> and <strong>Released</strong> events: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ButtonWidget1 PressRelease.png" border="0" alt="" title=""></p><p class="Element10">
8. Click the button on the right side to bring up the<strong> Events Editor</strong> for the <strong>Pressed</strong> event and create a new action. </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG Create New.png" border="0" alt="" title=""></p><p class="Element10">
9. When the <strong>Action Edit</strong> dialog appears. Enter the name <strong>ButtonPressed</strong> and click <strong>Next</strong>.&nbsp;</p>
<p class="Element10">
10. Now select which widget the <strong>ButtonPressed</strong> event of ButtonWidget1 affects. This event can affect any of the display's widgets. However, the objective is for the <strong>ButtonPressed</strong> event to change the visibility of the <strong>ImageWidget1</strong> widget (MPLAB Harmony Logo).&nbsp;</p>
<p class="Element10">
Therefore, select <strong>ImageWidget1</strong> and click <strong>Next</strong>: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ImageWidget1 ActionEdit.png" border="0" alt="" title=""></p><p class="Element10">
11. The next dialog window provides instructions to select the action associated with this event. There are many choices, from Adjust Position to Set Y Position, all of which are related to properties of the image widget. Select <strong>Set Visible</strong> as the action, and then click <strong>Next</strong>: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ButtonPress_AED.png" border="0" alt="" title=""></p><p class="Element10">
12. Set the argument for the Set Visible action by disabling visibility: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ButtonPress_SetVis.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10" style="text-align: center;">
&nbsp;</p>
<p class="Element10">
Then select the <strong>Finish</strong> button. This action resurfaces the<strong> Event Editor – Pressed</strong> dialog. Click on <strong>OK</strong> to close this dialog.&nbsp;</p>
<p class="Element10">
13. Follow the same steps for the <strong>Released</strong> event, but instead create a new event named <strong>ButtonReleased</strong>. Use the same <strong>Set Visible</strong> action as before but leave the visibility argument enabled. This will restore the logo’s visibility when the button is released.&nbsp;</p>
<p class="Element10">
14. Close the Graphics Composer window and save the new design. </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG CloseComposer.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10" style="text-align: center;">
&nbsp;</p>
<p class="Element10" style="text-align: center;">
&nbsp;</p><p class="Element10">
15. In the MPLAB Harmony Configurator (MHC) window save the new configuration, since it has been modified. Generate code for this new project configuration by selecting the Generate icon&nbsp;</p>
<p class="Element10">
( <img src="MHGC UG GenerateCodeSelection.png" border="0" alt="" title="">). Select <strong>USER_ALL</strong> as the Merging Strategy, since a review all the changes made to the graphics design is not necessary. Then select the <strong>Generate</strong> button to generate the new code that implements the events that have just been added.&nbsp;</p>
<p class="Element10">
16. Select the <strong>Run Main Project</strong> icon (<img src="MHGC UG RunMainProject.png" border="0" alt="" title=""> ) to build, load, and run this new configuration.&nbsp;</p>
<p class="Element10">
17. Pressing the screen’s button should hide the logo and releasing the button should cause the logo to reappear.&nbsp;</p>
<p class="Element10">
Exploring the code:&nbsp;</p>
<p class="Element10">
Double click on the libaria_events.c file to examine the graphics events just created:&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>Exploring the code</strong>:&nbsp;</p>
<p class="Element10">
Double click on the libaria_events.c file to examine the graphics events just created: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ExploreEvents.png" border="0" alt="" title=""></p><p class="Element10">
(This file is located in .\aria_quickstart\firmware\src\config\lcc_rgb565_mxt\gfx\libaria folder.)&nbsp;</p>
<p class="Element10">
The two events are defined in:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element13"><div class="Element12"><pre class="Element12"><strong><span style="color: #000080">#include</span></strong> &quot;gfx/libaria/libaria_events.h&quot;

<i><span style="color: #008000">// ButtonWidget1 - PressedEvent</span></i>
<strong><span style="color: #000080">void</span></strong> ButtonWidget1_PressedEvent(laButtonWidget* btn)
{
    <i><span style="color: #008000">// ButtonPressed - Set Visible - ImageWidget1</span></i>
    laWidget_SetVisible((laWidget*)ImageWidget1, LA_FALSE);
}

<i><span style="color: #008000">// ButtonWidget1 - ReleasedEvent</span></i>
<strong><span style="color: #000080">void</span></strong> ButtonWidget1_ReleasedEvent(laButtonWidget* btn)
{
    <i><span style="color: #008000">// ButtonReleased - Set Visible - ImageWidget1</span></i>
    laWidget_SetVisible((laWidget*)ImageWidget1, LA_TRUE);
}</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
The MPLAB Logo image is created in the ScreenCreate_default function found in libaria_init.c.&nbsp;</p>
<p class="Element10">
(Located in the same folder as libaria_events.c):&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element13"><div class="Element12"><pre class="Element12"><strong><span style="color: #000080">static</span></strong> <strong><span style="color: #000080">void</span></strong> ScreenCreate_default(laScreen* screen)
{
    laLayer* layer0;

    layer0 = laLayer_New();
    laWidget_SetPosition((laWidget*)layer0, 0, 0);
    laWidget_SetSize((laWidget*)layer0, 480, 272);
    laWidget_SetBackgroundType((laWidget*)layer0, LA_WIDGET_BACKGROUND_FILL);
    laLayer_SetBufferCount(layer0, 1);
    laLayer_SetVSync(layer0, LA_FALSE);

    laScreen_SetLayer(screen, 0, layer0);
        .
        .
        .
    ImageWidget1 = laImageWidget_New();
    laWidget_SetPosition((laWidget*)ImageWidget1, 113, 39);
    laWidget_SetSize((laWidget*)ImageWidget1, 242, 150);
    laWidget_SetBackgroundType((laWidget*)ImageWidget1, LA_WIDGET_BACKGROUND_NONE);
    laWidget_SetBorderType((laWidget*)ImageWidget1, LA_WIDGET_BORDER_NONE);
    laImageWidget_SetImage(ImageWidget1, &amp;NewHarmonyLogo);
    laWidget_AddChild((laWidget*)layer0, (laWidget*)ImageWidget1);
        .
        .
        .
}</pre></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
One might ask whether it would be more “efficient” to delete the image widget instead of setting it to be invisible and then recreating it again to make it visible. Launching the <strong>Heap Estimator</strong> tool from the MPLAB Harmony Graphics Configurator (MHGC) Tools menu and then selecting <strong>Calculate</strong> shows that only 172 bytes of heap space is used to create the image in the first place: </p><p class="Element10" style="text-align: center;">
<img src="MHGC UG ImageWidgetHeapEst.png" border="0" alt="" title=""></p><p class="Element10">
So not much heap space is saved by deleting the image. It is simpler to hide/reveal the image using the visibility property instead. Note that the logo image is stored separately in flash memory.</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00410.html" target="topic">MPLAB® Harmony Graphics Suite</a> &gt; <a href="03039.html" target="topic">Advanced Topics</a> &gt; <a href="03046.html" target="topic">Dynamic Graphics</a> &gt; <a href="03048.html" target="topic">Lesson 1: Dynamic Images, Part 1</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element3">
MPLAB® Harmony Graphics Suite</div>
</td><td width="25%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00410.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element91">
<a href="03047.html" target="topic">Previous</a> | <a href="03046.html" target="topic">Up</a> | <a href="03049.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: MHGC UG Dynamic Images, Part 1 Topic Title: Lesson 1: Dynamic Images, Part 1)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>